var times=2;function createBallotPdf(t){let e=document.getElementById("canvases");document.body.contains(e)?e.innerHTML="":(document.body.insertAdjacentHTML("beforeend",'<div id="canvases" style="display:none"></div>'),e=document.getElementById("canvases"));const i=new jsPDF("p","px","letter"),n=i.internal.pageSize.getWidth(),a=i.internal.pageSize.getHeight(),s='<canvas id="CANVAS_ID" width="'+850*times+'" height="'+1100*times+'" style="border:1px solid black; display:block;"></canvas>';t.pages.forEach((l,d)=>{let o="canvas"+d;e.insertAdjacentHTML("beforeend",s.replace("CANVAS_ID",o));let r=document.getElementById(o);drawPage(r,t,d),d>0&&i.addPage();let h=r.toDataURL("image/jpeg",1);i.addImage(h,"JPG",0,0,n,a)}),i.save("ballot.pdf")}function drawPage(t,e,n){let a=t.getContext("2d");a.drawFilledRect(0,0,t.width,t.height,"white");var s=e.pages[n].rectangles;for(i=0;i<s.length;i++){var l=s[i];0==l.width?a.drawFilledRect(l.x,l.y,l.dx,l.dy,l.fillStyle):a.drawRect(l.x,l.y,l.dx,l.dy,l.width)}a.fillStyle="black",a.strokeStyle="black";var d=e.pages[n].lines;for(i=0;i<d.length;i++){var o=d[i];a.drawLine(o.x1,o.y1,o.x2,o.y2,o.width)}var r=e.pages[n].textLines;for(i=0;i<r.length;i++){var h=r[i];a.drawTextLine(h.txt,h.x,h.y,h.font,h.align)}var c=e.pages[n].textAreas;for(console.log("number of textAreas = "+c.length),i=0;i<c.length;i++){h=c[i];a.drawTextArea(h.txt,h.x,h.y,h.width,h.lineHeight,h.font)}drawOvals(a,e,n)}function drawOvals(t,e,n){var a=0;for(i=0;i<e.contests.length;i++)if(e.contests[i].pageIndex==n){var s=e.contests[i].candidates;for(j=0;j<s.length;j++){var l=s[j];a=l.selected;var d=l.ovals;for(k=0;k<d.length;k++)t.drawOval(d[k].x,d[k].y,!1);a>0&&(t.drawOval(d[a-1].x,d[a-1].y,!0),void 0!==l.nameRectangle&&t.drawTextArea(l.candidateName,l.nameRectangle.x+96,l.nameRectangle.y+31,l.nameRectangle.width-96,12,"11px Arial"))}}}function adjustFontSize(t){let e=t.match(/\d+px/i);if(String(e).length>0){const i=String(e),n=i.slice(0,i.length-2)*times+"px";t=t.replace(i,n)}return t}CanvasRenderingContext2D.prototype.drawOval=function(t,e,i){this.beginPath(),t+=40,e+=30,this.ellipse(t*times,e*times,9.5*times,6.5*times,0,0,2*Math.PI),this.stroke(),i&&this.fill()},CanvasRenderingContext2D.prototype.drawLine=function(t,e,i,n,a){this.beginPath(),this.lineWidth=a*times,this.moveTo(t*times,e*times),this.lineTo(i*times,n*times),this.stroke()},CanvasRenderingContext2D.prototype.drawRect=function(t,e,i,n,a){this.lineWidth=a*times,this.strokeRect(t*times,e*times,i*times,n*times)},CanvasRenderingContext2D.prototype.drawFilledRect=function(t,e,i,n,a){this.fillStyle=a,this.fillRect(t*times,e*times,i*times,n*times),this.fillStyle="black"},CanvasRenderingContext2D.prototype.drawTextArea=function(t,e,i,n,a,s=""){""!==s&&(this.font=adjustFontSize(s)),this.textAlign="left",this.textBaseline="top",e+=2,e*=times,i+=2,i*=times,n-=7,n*=times,a*=times;let l,d,o,r,h,c,g=t.split("\\n");for(l=0;l<g.length;l++){if(o="",""!=g[l])for(h=g[l].split(" "),d=0;d<h.length;d++)c=h[d],r=""===o?c:o+" "+c,this.measureText(r).width>n?(this.fillText(o,e,i),i+=a,o=c):o=r;""!=g[l]?(this.fillText(o,e,i),i+=a):i+=.75*a}},CanvasRenderingContext2D.prototype.drawTextLine=function(t,e,i,n="",a=""){""!==n&&(this.font=adjustFontSize(n)),""!==a&&(this.textAlign=a),this.textBaseline="top",e+=2,i+=2,this.fillText(t,e*times,i*times)};